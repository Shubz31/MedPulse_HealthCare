{
  "version": 3,
  "sources": [],
  "debugId": "6d14576e-6f89-9787-ac2b-84d535ad68ab",
  "sections": [
    {"offset": {"line": 173, "column": 0}, "map": {"version":3,"sources":["file:///Users/macbook/Desktop/My%20Projects/medpulse/medpulse/lib/appwrite.config.ts"],"sourcesContent":["import * as sdk from \"node-appwrite\";\n\nconst client = new sdk.Client();\n\nclient\n  .setEndpoint(process.env.ENDPOINT!)        // https://cloud.appwrite.io/v1\n  .setProject(process.env.PROJECT_ID!)\n  .setKey(process.env.API_KEY!);\n\n// Appwrite services\nexport const databases = new sdk.Databases(client);\nexport const storage = new sdk.Storage(client);\nexport const users = new sdk.Users(client);\nexport const messaging = new sdk.Messaging(client);\n\n// Export IDs\nexport const ENDPOINT = process.env.ENDPOINT!;\nexport const PROJECT_ID = process.env.PROJECT_ID!;\nexport const API_KEY = process.env.API_KEY!;\nexport const DATABASE_ID = process.env.DATABASE_ID!;\nexport const PATIENT_COLLECTION_ID = process.env.PATIENTS_COLLECTION_ID!;\nexport const APPOINTMENT_COLLECTION_ID = process.env.APPOINTMENTS_COLLECTION_ID!;\nexport const BUCKET_ID = process.env.BUCKET_ID!;\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEA,MAAM,SAAS,IAAI,6KAAU;AAE7B,OACG,WAAW,CAAC,QAAQ,GAAG,CAAC,QAAQ,EAAU,+BAA+B;CACzE,UAAU,CAAC,QAAQ,GAAG,CAAC,UAAU,EACjC,MAAM,CAAC,QAAQ,GAAG,CAAC,OAAO;AAGtB,MAAM,YAAY,IAAI,+KAAa,CAAC;AACpC,MAAM,UAAU,IAAI,2KAAW,CAAC;AAChC,MAAM,QAAQ,IAAI,uKAAS,CAAC;AAC5B,MAAM,YAAY,IAAI,+KAAa,CAAC;AAGpC,MAAM,WAAW,QAAQ,GAAG,CAAC,QAAQ;AACrC,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU;AACzC,MAAM,UAAU,QAAQ,GAAG,CAAC,OAAO;AACnC,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAC3C,MAAM,wBAAwB,QAAQ,GAAG,CAAC,sBAAsB;AAChE,MAAM,4BAA4B,QAAQ,GAAG,CAAC,0BAA0B;AACxE,MAAM,YAAY,QAAQ,GAAG,CAAC,SAAS","debugId":null}},
    {"offset": {"line": 222, "column": 0}, "map": {"version":3,"sources":["file:///Users/macbook/Desktop/My%20Projects/medpulse/medpulse/lib/actions/appointment.action.ts"],"sourcesContent":["\"use server\";\n\nimport { ID, Query } from \"node-appwrite\";\nimport { \n  APPOINTMENT_COLLECTION_ID, \n  DATABASE_ID, \n  PATIENT_COLLECTION_ID, \n  databases,\n  messaging\n} from \"../appwrite.config\";\nimport { formatDateTime, parseStringify } from \"../utils\";\nimport { Appointment, Patient } from \"@/types/appwrite.types\";\nimport { revalidatePath } from \"next/cache\";\nimport { send } from \"node:process\";\n\nexport const createAppointment = async (appointment: CreateAppointmentParams) => {\n  try {\n    const newAppointment = await databases.createDocument(\n      DATABASE_ID!,\n      APPOINTMENT_COLLECTION_ID!,\n      ID.unique(),\n      appointment\n    );\n\n    return parseStringify(newAppointment);\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nexport const getAppointment = async (appointmentId: string) => {\n  try {\n    const appointment = await databases.getDocument(\n      DATABASE_ID!,\n      APPOINTMENT_COLLECTION_ID,\n      appointmentId\n    );\n\n    return parseStringify(appointment);\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nexport const getRecentAppointmentList = async () => {\n  try {\n    const appointments = await databases.listDocuments(\n      DATABASE_ID!,\n      APPOINTMENT_COLLECTION_ID!,\n      [Query.orderDesc(\"$createdAt\")]\n    );\n\n \n    const enrichedAppointments = await Promise.all(\n      appointments.documents.map(async (appointment: any) => {\n        try {\n          const patient = await databases.getDocument(\n            DATABASE_ID!,\n            PATIENT_COLLECTION_ID!,  \n            appointment.patient         \n          );\n\n          return {\n            ...appointment,\n            patient, \n          };\n        } catch (err) {\n          console.log(\"Failed to fetch patient:\", err);\n          return appointment; \n        }\n      })\n    );\n\n    const initialCounts = {\n      scheduledCount: 0,\n      pendingCount: 0,\n      cancelledCount: 0,\n    };\n\n    enrichedAppointments.forEach((a: any) => {\n      if (a.status === \"scheduled\") initialCounts.scheduledCount++;\n      if (a.status === \"pending\") initialCounts.pendingCount++;\n      if (a.status === \"cancelled\") initialCounts.cancelledCount++;\n    });\n\n    return parseStringify({\n      totalCount: appointments.total,\n      ...initialCounts,\n      documents: enrichedAppointments,\n    });\n\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nexport const updateAppointment = async ({\n  appointmentId,\n  userId,\n  appointment,\n  type,\n}: UpdateAppointmentParams) => {\n  try {\n    const updatedAppointment = await databases.updateDocument(\n      DATABASE_ID!,\n      APPOINTMENT_COLLECTION_ID!,\n      appointmentId,\n      appointment\n    );\n\n    if (!updatedAppointment) {\n      throw new Error(\"Appointment not found\");\n    }\n\n    const smsMessage = `\n      Hi, it's MedPulse.\n      ${type === 'schedule' \n        ? `Your appointment has been scheduled for ${formatDateTime(appointment.schedule!).dateTime} \n        with Dr. ${appointment.primaryPhysician}.` \n        : `We regret to inform you that your appointment has been cancelled for the following reason: \n        ${appointment.cancellationReason}`}\n      `\n    await sendSMSNotification(userId, smsMessage);\n    revalidatePath(\"/admin\");\n\n    return parseStringify(updatedAppointment);\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nexport const sendSMSNotification = async (userId: string, content: string) => {\n  try {\n    const message = await messaging.createSms(\n      ID.unique(),\n      content,\n      [],\n      [userId]\n    )\n\n    return parseStringify(message);\n  } catch (error) {\n    console.log(error)\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAEA;AAAA;AAAA;AACA;AAOA;AAEA;;;;;;;AAGO,MAAM,oBAAoB,OAAO;IACtC,IAAI;QACF,MAAM,iBAAiB,MAAM,sIAAS,CAAC,cAAc,CACnD,wIAAW,EACX,sJAAyB,EACzB,qJAAE,CAAC,MAAM,IACT;QAGF,OAAO,IAAA,8HAAc,EAAC;IACxB,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC;IACd;AACF;AAEO,MAAM,iBAAiB,OAAO;IACnC,IAAI;QACF,MAAM,cAAc,MAAM,sIAAS,CAAC,WAAW,CAC7C,wIAAW,EACX,sJAAyB,EACzB;QAGF,OAAO,IAAA,8HAAc,EAAC;IACxB,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC;IACd;AACF;AAEO,MAAM,2BAA2B;IACtC,IAAI;QACF,MAAM,eAAe,MAAM,sIAAS,CAAC,aAAa,CAChD,wIAAW,EACX,sJAAyB,EACzB;YAAC,2JAAK,CAAC,SAAS,CAAC;SAAc;QAIjC,MAAM,uBAAuB,MAAM,QAAQ,GAAG,CAC5C,aAAa,SAAS,CAAC,GAAG,CAAC,OAAO;YAChC,IAAI;gBACF,MAAM,UAAU,MAAM,sIAAS,CAAC,WAAW,CACzC,wIAAW,EACX,kJAAqB,EACrB,YAAY,OAAO;gBAGrB,OAAO;oBACL,GAAG,WAAW;oBACd;gBACF;YACF,EAAE,OAAO,KAAK;gBACZ,QAAQ,GAAG,CAAC,4BAA4B;gBACxC,OAAO;YACT;QACF;QAGF,MAAM,gBAAgB;YACpB,gBAAgB;YAChB,cAAc;YACd,gBAAgB;QAClB;QAEA,qBAAqB,OAAO,CAAC,CAAC;YAC5B,IAAI,EAAE,MAAM,KAAK,aAAa,cAAc,cAAc;YAC1D,IAAI,EAAE,MAAM,KAAK,WAAW,cAAc,YAAY;YACtD,IAAI,EAAE,MAAM,KAAK,aAAa,cAAc,cAAc;QAC5D;QAEA,OAAO,IAAA,8HAAc,EAAC;YACpB,YAAY,aAAa,KAAK;YAC9B,GAAG,aAAa;YAChB,WAAW;QACb;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC;IACd;AACF;AAEO,MAAM,oBAAoB,OAAO,EACtC,aAAa,EACb,MAAM,EACN,WAAW,EACX,IAAI,EACoB;IACxB,IAAI;QACF,MAAM,qBAAqB,MAAM,sIAAS,CAAC,cAAc,CACvD,wIAAW,EACX,sJAAyB,EACzB,eACA;QAGF,IAAI,CAAC,oBAAoB;YACvB,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,aAAa,CAAC;;MAElB,EAAE,SAAS,aACP,CAAC,wCAAwC,EAAE,IAAA,8HAAc,EAAC,YAAY,QAAQ,EAAG,QAAQ,CAAC;iBACnF,EAAE,YAAY,gBAAgB,CAAC,CAAC,CAAC,GACxC,CAAC;QACH,EAAE,YAAY,kBAAkB,EAAE,CAAC;MACrC,CAAC;QACH,MAAM,oBAAoB,QAAQ;QAClC,IAAA,+IAAc,EAAC;QAEf,OAAO,IAAA,8HAAc,EAAC;IACxB,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC;IACd;AACF;AAEO,MAAM,sBAAsB,OAAO,QAAgB;IACxD,IAAI;QACF,MAAM,UAAU,MAAM,sIAAS,CAAC,SAAS,CACvC,qJAAE,CAAC,MAAM,IACT,SACA,EAAE,EACF;YAAC;SAAO;QAGV,OAAO,IAAA,8HAAc,EAAC;IACxB,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC;IACd;AACF;;;IAjIa;IAeA;IAcA;IAoDA;IAmCA;;AApHA,+OAAA;AAeA,+OAAA;AAcA,+OAAA;AAoDA,+OAAA;AAmCA,+OAAA","debugId":null}},
    {"offset": {"line": 351, "column": 0}, "map": {"version":3,"sources":["file:///Users/macbook/Desktop/My%20Projects/medpulse/medpulse/lib/actions/patient.action.ts"],"sourcesContent":["\"use server\";\n\nimport { ID, Query } from \"node-appwrite\";\nimport {\n  users,\n  storage,\n  databases,\n  BUCKET_ID,\n  DATABASE_ID,\n  PATIENT_COLLECTION_ID,\n  ENDPOINT,\n  PROJECT_ID,\n} from \"../appwrite.config\";\n\nimport { InputFile } from \"node-appwrite/file\";\n\nconst parseStringify = (obj: any) => {\n  try {\n    return JSON.parse(JSON.stringify(obj));\n  } catch {\n    return obj;\n  }\n};\n\nexport const createUser = async (user: CreateUserParams) => {\n  try {\n    const newUser = await users.create(ID.unique(), user.email, user.phone, undefined, user.name);\n    return parseStringify(newUser);\n  } catch (error: any) {\n  \n    if (error?.code === 409) {\n      const existing = await users.list([Query.equal(\"email\", [user.email])]);\n      if (existing?.users?.length) return parseStringify(existing.users[0]);\n    }\n    throw error;\n  }\n};\n\nexport const getUser = async (userId: string) => {\n  if (!userId) {\n    console.error(\"getUser called without userId\");\n    return null;\n  }\n  try {\n    const user = await users.get(userId);\n    return parseStringify(user);\n  } catch (error) {\n    console.log(\" getUser ERROR:\", error);\n    return null;\n  }\n};\n\nexport const getPatient = async (userId: string) => {\n  if (!userId) {\n    console.error(\"getPatient called without userId\");\n    return null;\n  }\n\n  if (!DATABASE_ID || !PATIENT_COLLECTION_ID) {\n    console.error(\"Database configuration is missing\");\n    return null;\n  }\n\n  try {\n    const patients = await databases.listDocuments(DATABASE_ID, PATIENT_COLLECTION_ID, [\n      Query.equal(\"userId\", [userId]),\n    ]);\n\n    if (!patients || patients.documents.length === 0) return null;\n    return parseStringify(patients.documents[0]);\n  } catch (error) {\n    console.log(\" getPatient ERROR:\", error);\n    return null;\n  }\n};\n\nexport const registerPatient = async ({ identificationDocument, ...patient }: RegisterUserParams) => {\n  try {\n    let uploadedFile = null;\n\n    if (identificationDocument instanceof FormData) {\n      const blob = identificationDocument.get(\"blobFile\") as Blob | null;\n      const fileName = identificationDocument.get(\"fileName\") as string | null;\n\n      if (blob && fileName && BUCKET_ID) {\n        const buffer = Buffer.from(await blob.arrayBuffer());\n        const inputFile = InputFile.fromBuffer(buffer, fileName);\n        uploadedFile = await storage.createFile(BUCKET_ID, ID.unique(), inputFile);\n      }\n    }\n\n    const newPatient = await databases.createDocument(\n      DATABASE_ID!,\n      PATIENT_COLLECTION_ID!,\n      ID.unique(),\n      {\n        ...patient,\n        userId: patient.userId,\n        identificationDocumentId: uploadedFile?.$id || null,\n        identificationDocumentUrl: uploadedFile\n          ? `${ENDPOINT}/storage/buckets/${BUCKET_ID}/files/${uploadedFile.$id}/view?project=${PROJECT_ID}`\n          : null,\n      }\n    );\n\n    return parseStringify(newPatient);\n  } catch (error) {\n    console.log(\"registerPatient ERROR:\", error);\n    return null;\n  }\n};\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AAAA;AAAA;AACA;AAWA;;;;;;AAEA,MAAM,iBAAiB,CAAC;IACtB,IAAI;QACF,OAAO,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC;IACnC,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,MAAM,aAAa,OAAO;IAC/B,IAAI;QACF,MAAM,UAAU,MAAM,kIAAK,CAAC,MAAM,CAAC,qJAAE,CAAC,MAAM,IAAI,KAAK,KAAK,EAAE,KAAK,KAAK,EAAE,WAAW,KAAK,IAAI;QAC5F,OAAO,eAAe;IACxB,EAAE,OAAO,OAAY;QAEnB,IAAI,OAAO,SAAS,KAAK;YACvB,MAAM,WAAW,MAAM,kIAAK,CAAC,IAAI,CAAC;gBAAC,2JAAK,CAAC,KAAK,CAAC,SAAS;oBAAC,KAAK,KAAK;iBAAC;aAAE;YACtE,IAAI,UAAU,OAAO,QAAQ,OAAO,eAAe,SAAS,KAAK,CAAC,EAAE;QACtE;QACA,MAAM;IACR;AACF;AAEO,MAAM,UAAU,OAAO;IAC5B,IAAI,CAAC,QAAQ;QACX,QAAQ,KAAK,CAAC;QACd,OAAO;IACT;IACA,IAAI;QACF,MAAM,OAAO,MAAM,kIAAK,CAAC,GAAG,CAAC;QAC7B,OAAO,eAAe;IACxB,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC,mBAAmB;QAC/B,OAAO;IACT;AACF;AAEO,MAAM,aAAa,OAAO;IAC/B,IAAI,CAAC,QAAQ;QACX,QAAQ,KAAK,CAAC;QACd,OAAO;IACT;IAEA,IAAI,CAAC,wIAAW,IAAI,CAAC,kJAAqB,EAAE;QAC1C,QAAQ,KAAK,CAAC;QACd,OAAO;IACT;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,sIAAS,CAAC,aAAa,CAAC,wIAAW,EAAE,kJAAqB,EAAE;YACjF,2JAAK,CAAC,KAAK,CAAC,UAAU;gBAAC;aAAO;SAC/B;QAED,IAAI,CAAC,YAAY,SAAS,SAAS,CAAC,MAAM,KAAK,GAAG,OAAO;QACzD,OAAO,eAAe,SAAS,SAAS,CAAC,EAAE;IAC7C,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC,sBAAsB;QAClC,OAAO;IACT;AACF;AAEO,MAAM,kBAAkB,OAAO,EAAE,sBAAsB,EAAE,GAAG,SAA6B;IAC9F,IAAI;QACF,IAAI,eAAe;QAEnB,IAAI,kCAAkC,UAAU;YAC9C,MAAM,OAAO,uBAAuB,GAAG,CAAC;YACxC,MAAM,WAAW,uBAAuB,GAAG,CAAC;YAE5C,IAAI,QAAQ,YAAY,sIAAS,EAAE;gBACjC,MAAM,SAAS,OAAO,IAAI,CAAC,MAAM,KAAK,WAAW;gBACjD,MAAM,YAAY,mKAAS,CAAC,UAAU,CAAC,QAAQ;gBAC/C,eAAe,MAAM,oIAAO,CAAC,UAAU,CAAC,sIAAS,EAAE,qJAAE,CAAC,MAAM,IAAI;YAClE;QACF;QAEA,MAAM,aAAa,MAAM,sIAAS,CAAC,cAAc,CAC/C,wIAAW,EACX,kJAAqB,EACrB,qJAAE,CAAC,MAAM,IACT;YACE,GAAG,OAAO;YACV,QAAQ,QAAQ,MAAM;YACtB,0BAA0B,cAAc,OAAO;YAC/C,2BAA2B,eACvB,GAAG,qIAAQ,CAAC,iBAAiB,EAAE,sIAAS,CAAC,OAAO,EAAE,aAAa,GAAG,CAAC,cAAc,EAAE,uIAAU,EAAE,GAC/F;QACN;QAGF,OAAO,eAAe;IACxB,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC,0BAA0B;QACtC,OAAO;IACT;AACF;;;IAtFa;IAcA;IAcA;IAwBA;;AApDA,+OAAA;AAcA,+OAAA;AAcA,+OAAA;AAwBA,+OAAA","debugId":null}},
    {"offset": {"line": 469, "column": 0}, "map": {"version":3,"sources":["file:///Users/macbook/Desktop/My%20Projects/medpulse/medpulse/.next-internal/server/app/admin/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {sendSMSNotification as '7f0483f907b6b7b1827b1208467c6a471908db9622'} from 'ACTIONS_MODULE0'\nexport {getAppointment as '7f12d9382c77db85eb040961233a41693076baf1a3'} from 'ACTIONS_MODULE0'\nexport {getRecentAppointmentList as '7f692acfa1cf0bf33e68f3731cd025aa8a120e0a86'} from 'ACTIONS_MODULE0'\nexport {updateAppointment as '7f83832d45f20388233bfd9d3f05a4a3b2432bc5f0'} from 'ACTIONS_MODULE0'\nexport {createAppointment as '7fe7a95cf35bd2bb25bf919763ddf3ddaf6c525035'} from 'ACTIONS_MODULE0'\nexport {createAppointment as '7fe7a95cf35bd2bb25bf919763ddf3ddaf6c525035'} from 'ACTIONS_MODULE0'\nexport {updateAppointment as '7f83832d45f20388233bfd9d3f05a4a3b2432bc5f0'} from 'ACTIONS_MODULE0'\nexport {createUser as '7f9c5e53690ee00206b4f2d7e0bbf11c7a78c22fa2'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":";AAAA;AAOA","debugId":null}}]
}